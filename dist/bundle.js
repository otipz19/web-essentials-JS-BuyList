(()=>{"use strict";const t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let e;const n=new Uint8Array(16);function o(){if(!e&&(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}const r=[];for(let t=0;t<256;++t)r.push((t+256).toString(16).slice(1));const u=function(e,n,u){if(t.randomUUID&&!n&&!e)return t.randomUUID();const l=(e=e||{}).random||(e.rng||o)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,n){u=u||0;for(let t=0;t<16;++t)n[u+t]=l[t];return n}return function(t,e=0){return r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]}(l)},l="productNameToData",i="productIdToName";null==localStorage.getItem(l)&&localStorage.setItem(l,"[]"),null==localStorage.getItem(i)&&localStorage.setItem(i,"[]"),q().forEach(((t,e)=>{a(e,g(t))}));let c=document.querySelector("form.create-product-bar");function a(t,e){let n=function(t,e){let n=m(document.getElementById("product-list-item-template"));return f(n,e),function(t,e,n){let o=t.querySelector("input.product-title");o.value=e,o.addEventListener("change",(()=>{let t=s(n).firstElementChild;if(p(o.value))alert(`Товар з назвою ${o.value} вже існує!`),o.value=t.innerText;else if(""!=o.value){let r=o.value,u=e;E(n,r);let l=g(u);b(u),l.name=r,t.innerText=r,y(l.name,l)}else o.value=t.innerText}))}(n,t.name,e),function(t,e){t.querySelector("button.cancel-btn").addEventListener("click",(()=>{let t=h(e);!function(t){let e=q();e.delete(t),I(e)}(e),b(t),document.querySelectorAll(`[data-product-id="${e}"]`).forEach((t=>t.remove()))}))}(n,e),function(t,e){let n=t.querySelector(".buy-btn");n.addEventListener("click",(()=>{var o;let r="false"===n.getAttribute("data-product-bought"),u=h(e),l=g(u);l.isBought=r,y(u,l),n.setAttribute("data-product-bought",r.toString()),n.innerText=r?"Не куплено":"Куплено",n.setAttribute("data-tooltip",r?"Відмінити покупку":"Підтвердити покупку");let i=t.querySelector(".product-title");i.disabled=r,i.classList.toggle("strike-through"),t.querySelectorAll(".product-amount-btn").forEach((t=>t.style.display=r?"none":"block")),t.querySelector(".cancel-btn").style.display=r?"none":"block";let c=s(e);c.remove();let a=document.getElementById(r?"bought-section":"not-bought-section");null===(o=c.firstElementChild)||void 0===o||o.classList.toggle("strike-through"),a.appendChild(c)}))}(n,e),function(t,e,n){t.querySelector(".btn-sub").addEventListener("click",(()=>{d(e,t,(t=>--t))})),t.querySelector(".btn-add").addEventListener("click",(()=>{d(e,t,(t=>++t))}))}(n,e,t.amount),function(t){document.getElementsByClassName("products-list")[0].appendChild(t)}(n),n}(e,t);(function(t,e){let n=m(document.getElementById("statistics-item-template"));f(n,e),n.querySelectorAll("span > span")[0].innerText=t.name,document.getElementById("not-bought-section").appendChild(n)})(e,t),e.isBought&&n.querySelector(".buy-btn").click(),d(t,n,(t=>e.amount))}function d(t,e,n){let o=e.querySelector(".product-amount-value"),r=s(t).querySelector(".amount"),u=h(t),l=g(u);l.amount=n(l.amount),y(u,l),e.querySelector(".btn-sub").disabled=1==l.amount,o.innerText=l.amount.toString(),r.innerText=l.amount.toString()}function s(t){return document.querySelector(`.statistics-item[data-product-id="${t}"]`)}function m(t){var e,n;return null===(n=null===(e=t.content)||void 0===e?void 0:e.firstElementChild)||void 0===n?void 0:n.cloneNode(!0)}function f(t,e){t.setAttribute("data-product-id",e)}function p(t){return S().has(t)}function g(t){return S().get(t)}function y(t,e){let n=S();n.set(t,e),v(n)}function b(t){let e=S();e.delete(t),v(e)}function S(){return U(l)}function v(t){T(t,l)}function h(t){return q().get(t)}function E(t,e){let n=q();n.set(t,e),I(n)}function q(){return U(i)}function I(t){T(t,i)}function U(t){let e=JSON.parse(localStorage.getItem(t));return new Map(e)}function T(t,e){localStorage.setItem(e,JSON.stringify(Array.from(t)))}c.addEventListener("submit",(t=>{t.preventDefault();let e=function(){let t=null==c?void 0:c.getElementsByTagName("input")[0];if(""==t.value)return null;let e=t.value;return t.value="",e}();if(null!=e)if(p(e))alert(`Товар з назвою ${e} вже існує!`);else{let t=u().toString();E(t,e);let n={name:e,amount:1,isBought:!1};y(e,n),a(t,n)}}))})();